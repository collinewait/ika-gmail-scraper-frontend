(this["webpackJsonptest-ika-oauth"]=this["webpackJsonptest-ika-oauth"]||[]).push([[0],{10:function(e,t,a){},11:function(e,t,a){},14:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(3),c=a.n(l),r=(a(10),a(1)),i=(a(11),a(4)),s=a.n(i),m=function(){return o.a.createElement("div",{className:"App-header"},o.a.createElement("h2",null,"IKA"))},u=function(e){var t=e.email,a=e.handleSubmit,n=e.handleChange;return o.a.createElement("div",{className:"Form"},o.a.createElement("form",{onSubmit:a},o.a.createElement("input",{type:"email",value:t,placeholder:"Email that sent attachment",className:"Form-drawingInput",onChange:n}),o.a.createElement("button",{"data-download-btn":"download-btn",type:"submit",className:"Form-button"},"Download")))},d=function(){window.location.href="".concat("https://ika-gmail-scraper-backend.herokuapp.com","/auth/google/login")},h=function(e,t,a,n){var o,l=localStorage.getItem("login-token");if(l)if((o=l,s()(o)).exp>Date.now()/1e3){var c=function(e){return"Bearer ".concat(e)}(l);n(!0),a(null),t(!1),function(e,t,a,n,o){var l="".concat("https://ika-gmail-scraper-backend.herokuapp.com","/download/attachment?emailThatSentAttach=").concat(a);window.fetch(l,{method:"GET",headers:{Authorization:e},credentials:"include"}).then((function(e){if(200!==e.status)throw new Error("Something went wrong, please try again");return e.blob()})).then((function(e){var a=window.URL.createObjectURL(new Blob([e])),l=document.createElement("a");l.href=a;var c=new Date,r="".concat(c.toLocaleDateString("en-US",{day:"numeric"}),"-").concat(c.toLocaleDateString("en-US",{month:"short"}),"-").concat(c.toLocaleDateString("en-US",{year:"numeric"}));l.setAttribute("download","attachment-".concat(r,".zip")),l.click(),window.URL.revokeObjectURL(a),o(!1),n(null),t(!0)})).catch((function(e){o(!1),t(!1),localStorage.setItem("email",a),localStorage.removeItem("login-token"),n(e.message)}))}(c,t,e,a,n)}else localStorage.setItem("email",e),d();else localStorage.setItem("email",e),d()};var g=function(){var e=o.a.useState(""),t=Object(r.a)(e,2),a=t[0],n=t[1],l=o.a.useState(!1),c=Object(r.a)(l,2),i=c[0],s=c[1],d=o.a.useState(null),g=Object(r.a)(d,2),w=g[0],p=g[1],f=o.a.useState(!1),v=Object(r.a)(f,2),S=v[0],b=v[1];o.a.useEffect((function(){var e=new URLSearchParams(window.location.search).get("access_token");if(e){localStorage.setItem("login-token",e),window.history.replaceState(null,null,window.location.pathname);var t=localStorage.getItem("email");h(t,s,p,b),localStorage.removeItem("email")}}),[]);var E=function(e){return/.+@.+\..+/.test(e)};return o.a.createElement("div",{className:"App"},o.a.createElement(m,null),o.a.createElement("h3",{className:"simple-heading"},"Download Attachments sent by a specific email address"),w?o.a.createElement("div",{role:"alert",className:"error-message"},w):null,i?o.a.createElement("div",{role:"alert",className:"success-message"},"Download completed!"):null,S?o.a.createElement("div",{role:"alert",className:"loader"},"Downloading..."):null,o.a.createElement(u,{email:a,handleChange:function(e){n(e.target.value)},handleSubmit:function(e){e.preventDefault(),E(a)?h(a,s,p,b):(s(!1),p("Invalid email address"))}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},5:function(e,t,a){e.exports=a(14)}},[[5,1,2]]]);
//# sourceMappingURL=main.f0974238.chunk.js.map